\documentclass[10pt]{article}

\usepackage{mathtools}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{color}
\usepackage{fullwidth}
\usepackage{graphicx}
\usepackage[margin=0.6in]{geometry}
\usepackage{tikz}
\usepackage{float}
\usepackage[hidelinks, urlcolor=blue, linkcolor=blue, colorlinks=true]{hyperref} 

\DeclarePairedDelimiterX\set[1]\lbrace\rbrace{\def\given{\;\delimsize\vert\;}#1}

\newcommand{\bcent}{\begin{center}}
\newcommand{\ecent}{\end{center}}
\newcommand{\tb}{\textbf}
\newcommand{\noin}{\noindent}
\newcommand{\benum}{\begin{enumerate}}
\newcommand{\eenum}{\end{enumerate}}
\newcommand{\bitem}{\begin{itemize}}
\newcommand{\eitem}{\end{itemize}}
\def\boxx#1{
    \framebox{
    \begin{tabular}{c}
    \\[-1pt]
    #1 \\
    \\[-1pt]
    \end{tabular}
    }
}

%%% This command makes a framed box of a chosen height.
\newcommand{\makenonemptybox}[2]{%
\par\nobreak\vspace{\ht\strutbox}\noindent
\setlength{\fboxrule}{0pt} % set this to 0pt to make invisible
\fbox{%
\parbox[c][#1][t]{\dimexpr\linewidth-2\fboxsep}{
  \hrule width \hsize height 0pt
  #2
 }%
}%
}
\makeatother    


\begin{document}

{\bcent\fontfamily{cmss}\selectfont
\begin{tabular}{c}
\textbf{}~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\textbf{{\color{red} Due}: 11:59pm Sunday March 3, 2024}\\\hline
\end{tabular}\ecent
}

{\fontfamily{cmss}\selectfont
\large\bcent\tb{}\\
\tb{}\\
\vspace{0pt}
%\tb{Term Test 1}\\

\tb{\Large MAT185 Linear Algebra}\\

\tb{Assignment 3}
\ecent}



\noin{\fontfamily{cmss}\selectfont\tb{\large Instructions:}} \\ %% Fairly standard and designed to save time; however, tweak as necessary.

\noindent Please read the {\bf MAT185 Assignment Policies \& FAQ} document for details on submission policies, collaboration rules and academic integrity, and general instructions. 

\benum


\item {\bf Submissions are only accepted by} \href{https://www.gradescope.ca}{Gradescope}. Do not send anything by email.  Late submissions are not accepted under any circumstance. Remember you can resubmit anytime before the deadline. 

\item  {\bf Submit solutions using only this template pdf}.  Your submission should be a single pdf with your full written solutions for each question. If your solution is not written using this template pdf (scanned print or digital) then your submission will not be assessed. Organize your work neatly in the space provided.  Do not submit rough work. 

\item  {\bf Show your work and justify your steps} on every question but do not include extraneous information.  Put your final answer in the box provided, if necessary.  We recommend you write draft solutions on separate pages and afterwards write your polished solutions here on this template.

\item  {\bf You must fill out and sign the academic integrity statement below}; otherwise, you will receive zero for this assignment. 


\eenum

\vspace{30pt}


\noin{\fontfamily{cmss}\selectfont\tb{\large Academic Integrity Statement:}} \\

%%% Student information

% Student 1
\fbox{
\begin{minipage}{\textwidth}
{
\vspace{0.2in}

\makebox[\textwidth]{\sffamily Full Name:\enspace\hrulefill}

\vspace{0.2in}

\makebox[\textwidth]{\sffamily Student number:\enspace\hrulefill}

\vspace{0.1in}
}
\end{minipage}
}

\vspace*{0.1in}

% Student 2
\fbox{
\begin{minipage}{\textwidth}
{
\vspace{0.2in}

\makebox[\textwidth]{\sffamily Full Name:\enspace\hrulefill}

\vspace{0.2in}

\makebox[\textwidth]{\sffamily Student number:\enspace\hrulefill}

\vspace{0.1in}
}
\end{minipage}
}
~

I confirm that:

\begin{itemize} 
	\item I have read and followed the policies described in the document {\bf MAT185 Assignment Policies \& FAQ}.
	\item In particular, I have read and understand the rules for collaboration, and permitted resources on assignments as described in subsection II of the the aforementioned document. I have not violated these rules while completing and writing this assignment. 
	\item I understand the consequences of violating the University's academic integrity policies as outlined in the \href{http://www.governingcouncil.utoronto.ca/policies/behaveac.htm}{Code of Behaviour on Academic Matters}. I have not violated them while completing and writing this assignment.
\end{itemize}
By signing this document, I agree that the statements above are true. 

% You should sign this PDF after compiling. Do not write your signature using LaTeX.
\vspace{0.2in}
{\large 
\makebox[\textwidth]{\sffamily Signatures: 1)\enspace\hrulefill} 

\vspace{0.2in}

\makebox[\textwidth]{\sffamily \hspace*{20mm} 2)\enspace\hrulefill} 

}

\vfill


\pagebreak


\noin {\bf Preamble}: Rank factorization. \\

\noin Suppose that $A\in {^m}\mathbb R^k$ has rank $r\ge 1$.  Then $A$ has $r$ linearly independent columns that form a basis for $\mathrm{col}\, A$.  Let ${\bf b}_1, {\bf b}_2, \dots, {\bf b}_r$ be any basis for $\mathrm{col}\, A$, and let $B\in {^m}\mathbb R^r$ be the matrix whose columns are ${\bf b}_1, {\bf b}_2, \dots, {\bf b}_r$.  That is,

$$B=\begin{bmatrix} {\bf b}_1 & {\bf b_2} &\cdots& {\bf b}_r \end{bmatrix}.$$\\

\noin Then, every column of $A$ can be written as a linear combination of ${\bf b}_1, {\bf b}_2, \dots, {\bf b}_r$.  In other words, if ${\bf a}_1, {\bf a}_2, \dots, {\bf a}_k$ are the columns of $A$, then, for every $j=1, 2, \dots k$,

$${\bf a}_j = c_{1j}{\bf b}_1+c_{2j}{\bf b}_2+\cdots+c_{rj}{\bf b}_r$$

\noin for some scalars $c_{1j}, c_{2j}, \dots, c_{rj}\in \mathbb R$.\\

\noin Then,

\begin{align*}
A &= \begin{bmatrix} {\bf a}_1 & {\bf a}_2 & \dots& {\bf a}_k \end{bmatrix} \\
&=\begin{bmatrix} {\bf b}_1 & {\bf b_2} &\cdots& {\bf b}_r \end{bmatrix} \begin{bmatrix} c_{11} & c_{12} & \cdots &c_{1r} \\ c_{21} & c_{22} & \cdots &c_{2r} \\ \vdots & \vdots & \ddots & \vdots \\ c_{r1} & c_{r2} & \cdots &c_{rk}\end{bmatrix} \\
&=BC
\end{align*}



\noin where $B \in {^m}\mathbb R^r$, $C\in {^r}\mathbb R^k$, and $r=\mathrm{rank}\, A$.  This is called a {\it \color{blue} rank factorization} of $A$.

\vspace{20pt}

\noin In this assignment, we will see how such a rank factorization can help us investigate the rank of a sum of matrices.





\pagebreak

%%% Questions


\noin{1.} Let $A\in {^m}\mathbb R^k$,  and $B\in {^k}\mathbb R^n$.
\vspace{20pt}

\noin{(a)} Suppose that $AB=0$.  Prove that 
$$\mathrm{rank}\, A + \mathrm{rank}\, B - k \leq \mathrm{rank}\, AB.$$ \\

\noin{\it Hint}: Consider the cases where $A=0$ and $A\neq 0$.

%Question 1(a)

{
	\vspace*{-10pt}
	%%% Do not change the height of this box. Your work must fit inside it.
	
	\makenonemptybox{550pt}{

	%%% Your work goes here! 
	\begin{enumerate}
		\item \( AB = 0 \) implies that for all \( \mathbf{b} \in \text{col}(B) \), we have \( A\mathbf{b} = \mathbf{0} \). Hence, \( \text{col}(B) \subseteq \text{null}(A) \).
		\item By "Theorem II", we have \( \text{dim}(\text{null}(A)) = k - \text{rank}(A) \), where \( k \) is the number of columns of \( A \).
		\item Since \( \text{col}(B) \subseteq \text{null}(A) \), it follows that \( \text{rank}(B) \leq \text{dim}(\text{null}(A)) \).
		\item From "Theorem II", we deduce \( \text{rank}(B) \leq k - \text{rank}(A) \) which implies \( \text{rank}(A) + \text{rank}(B) - k \leq 0 \).
		\item The rank of any matrix, including the zero matrix \( AB \), is non-negative, hence \( \text{rank}(AB) = 0 \).
		\item Therefore, \( \text{rank}(A) + \text{rank}(B) - k \leq \text{rank}(AB) \), by substitution from the previous point.
	\end{enumerate}


	}
}

\pagebreak


\noin{1.} Let $A\in {^m}\mathbb R^k$,  and $B\in {^k}\mathbb R^n$.
\vspace{20pt}


\noin{(b)} Suppose that $AB\neq0$.  Prove that 
$$\mathrm{rank}\, A + \mathrm{rank}\, B - k \leq \mathrm{rank}\, AB.$$\\

\noin{\it Hint}:  Suppose that $\mathrm{rank}\, AB=r\ge 1$ and use a rank factorization $AB=CD$.  Let $X$ and $Y$ be the augmented matrices 
$$X=\begin{bmatrix} A & C \end{bmatrix} \,\,\, \mbox{ and } \,\,\, Y=\begin{bmatrix} B\\ -D \end{bmatrix}$$
(be sure to note the sizes of $C, D,  X, Y$) then compute $XY$ and use part (a).



%Question 1(b)

{
	\vspace*{-10pt}
	%%% Do not change the height of this box. Your work must fit inside it.
	
	\makenonemptybox{550pt}{

	%%% Your work goes here!
	\begin{enumerate}
		\item Assume \( AB \neq 0 \) with \( \text{rank}(AB) = r \geq 1 \), create rank factorization \( AB = CD \). \\
		
		\item Construct \( X = \begin{bmatrix} A & C \end{bmatrix} \), \( Y = \begin{bmatrix} B \\ -D \end{bmatrix} \), ensuring \( XY = 0 \) via \( CD = AB \). \\
		
		\item Validate \( XY = 0 \) through \( AB - CD = 0 \), leveraging rank factorization. \\
		
		\item Since \( \text{col}(A) \subseteq \text{col}(X) \), then \( \text{rank}(A) \leq \text{rank}(X) \). \\
		
		\item Since \( \text{row}(B) \subseteq \text{row}(Y) \), then \( \text{rank}(B) \leq \text{rank}(Y) \). \\
		
		\item By invoking part (a), note that \( \text{rank}(X) + \text{rank}(Y) - (k + r) \leq 0 \) holds due to \( XY = 0 \). This inequality reflects the principle that the sum of the ranks of two matrices minus the dimension they share cannot exceed the rank of their product, even when that product is the zero matrix. \\
		
		\item By substitution from step 4 to step 5: \( \text{rank}(A) + \text{rank}(B) - (k + r) \leq 0 \)\\
		
		\item Therefore \( \text{rank}(A) + \text{rank}(B) - k \leq r = \text{rank}(AB)\).
		
		
		\end{enumerate}
	
	}
}


\pagebreak

\noin{\bf 2.} Let $A\in {^m}\mathbb R^k$,  $B\in {^k}\mathbb R^n$.  Prove that the rank inequality $\mathrm{rank}\, A + \mathrm{rank}\, B - k \leq \mathrm{rank}\, AB.$ from Question 1. is equivalent to the inequality
$$\mathrm{nullity}\, AB \leq \mathrm{nullity}\, A +\mathrm{nullity}\, B$$


%Question 2
    
    {
	\vspace*{-10pt}
	%%% Do not change the height of this box. Your work must fit inside it.
	
	\makenonemptybox{550pt}{
	
	%%% Your work goes here! 
	\begin{enumerate}
		\item Start by applying the Rank-Nullity Theorem for matrix \( A \): \\
			  \( \text{rank}(A) + \text{nullity}(A) = k \). \label{step:rank_nullity_A}
		
		\item Apply the Rank-Nullity Theorem for matrix \( B \): \\
			  \( \text{rank}(B) + \text{nullity}(B) = n \). \label{step:rank_nullity_B}
		
		\item Apply the Rank-Nullity Theorem for matrix \( AB \): \\
			  \( \text{rank}(AB) + \text{nullity}(AB) = n \). \label{step:rank_nullity_AB}
		
		\item Use the inequality provided from Question 1, which can be expressed as: \\
			  \( \text{rank}(A) + \text{rank}(B) - k \leq \text{rank}(AB) \). \label{step:inequality_given}
		
		\item From the inequality in Step \ref{step:inequality_given}, replace \( \text{rank}(A) \) using Step \ref{step:rank_nullity_A}, resulting in: \\
			  \( k - \text{nullity}(A) + \text{rank}(B) - k \leq \text{rank}(AB) \). \label{step:replace_rank_A}
		
		\item Simplify the inequality obtained in Step \ref{step:replace_rank_A}: \\
			  \( \text{rank}(B) - \text{nullity}(A) \leq \text{rank}(AB) \). \label{step:simplify_inequality}
		
		\item Replacing \( \text{rank}(AB) \) using Step \ref{step:rank_nullity_AB} in the inequality from Step \ref{step:simplify_inequality}, we get: \\
			  \( \text{rank}(B) - \text{nullity}(A) \leq n - \text{nullity}(AB) \). \label{step:replace_rank_AB}
		
		\item Rearrange the inequality in Step \ref{step:replace_rank_AB}: \\
			  \( \text{nullity}(AB) \leq n - \text{rank}(B) + \text{nullity}(A) \). \label{step:rearrange_inequality}
		
		\item Finally, replace \( n - \text{rank}(B) \) using Step \ref{step:rank_nullity_B} in the inequality from Step \ref{step:rearrange_inequality}: \\
			  \( \text{nullity}(AB) \leq \text{nullity}(B) + \text{nullity}(A) \), which is the goal inequality. \label{step:final_step}
	\end{enumerate}
	
	
	}
}


\pagebreak


\noin{\bf 3.}   Let $A, B\in {^m}\mathbb R^n$. Prove that
$$|\, \mathrm{rank}\, A -\mathrm{rank}\, B\,| \leq \mathrm{rank}(A+B) \leq \mathrm{rank}\, A +\mathrm{rank}\, B$$\\

\noin{\it Hint}:  Prove each inequality separately.  Assume that $\mathrm{rank}\, A=r\ge 1$, and $\mathrm{rank}\, B=s\ge 1$, and use a rank factorization $A=CD$, and $B=EF$.  Let $X$ and $Y$ be the augmented matrices 
$$X=\begin{bmatrix} C & E \end{bmatrix} \,\,\, \mbox{ and } \,\,\, Y=\begin{bmatrix} D\\ F\end{bmatrix}$$
(be sure to note the sizes of $C, D, E, F, X, Y$) then compute $XY$ and use previous results.

%Question 3
{
	\vspace*{-10pt}
	%%% Do not change the height of this box. Your work must fit inside it.
	
	\makenonemptybox{550pt}{

	%%% Your work goes here! 
	\begin{enumerate}
		\item To prove \( \text{rank}(A+B) \leq \text{rank}(A) + \text{rank}(B) \):
		\begin{itemize}
			\item Let \( A, B \in \mathbb{R}^{m \times n} \) and assume that \( \text{rank}(A) = r \) and \( \text{rank}(B) = s \).
			\item We can write rank factorizations \( A = CD \) and \( B = EF \) where \( C, E \in \mathbb{R}^{m \times k} \) for some \( k \) and \( D, F \in \mathbb{R}^{k \times n} \).
			\item Consider the augmented matrix \( X = [C \ E] \in \mathbb{R}^{m \times 2k} \) and \( Y = \begin{bmatrix} D \\ F \end{bmatrix} \in \mathbb{R}^{2k \times n} \).
			\item The product \( XY \) represents \( A+B \) since \( CD + EF = A + B \).
			\item \( \text{rank}(XY) \) cannot exceed the total number of columns in \( X \) or the total number of rows in \( Y \), which is \( 2k \).
			\item Since \( k \) can be at most \( \text{rank}(A) \) or \( \text{rank}(B) \), it follows that \( \text{rank}(A+B) = \text{rank}(XY) \leq \text{rank}(A) + \text{rank}(B) \).
		\end{itemize}
		\item To prove \( | \text{rank}(A) - \text{rank}(B) | \leq \text{rank}(A+B) \):
		\begin{itemize}
			\item Using the same augmented matrices \( X \) and \( Y \) as in the previous proof, we have \( XY = A+B \).
			\item There exist the inequality \( \text{rank}(X) + \text{rank}(Y) - r - s \leq \text{rank}(A+B) \) from Question 1.
			\item Using the factorizations of \( A \) and \( B \), 
			\begin{itemize}
				\item Since \( \text{col}(C) \subseteq \text{col}(X) \), then \( \text{rank}(C) \leq \text{rank}(X) \).
				\item Since \( \text{col}(E) \subseteq \text{col}(X) \), then \( \text{rank}(E) \leq \text{rank}(X) \).
				\item Since \( \text{row}(D) \subseteq \text{row}(Y) \), then \( \text{rank}(D) \leq \text{rank}(Y) \).
				\item Since \( \text{row}(F) \subseteq \text{row}(Y) \), then \( \text{rank}(F) \leq \text{rank}(Y) \).
			\end{itemize}
			\item By substituting the inequalities above into the inequality from Question 1, we get \( \text{rank}(C) + \text{rank}(D) - r - s \leq \text{rank}(A+B) \), \(\text{rank}(E) + \text{rank}(F) - r - s \leq \text{rank}(A+B)\).
			\item \(\text{rank}(C) + \text{rank}(D) \leq \text{rank}(A + B) + r + s\), \(\text{rank}(E) + \text{rank}(F) \leq \text{rank}(A + B) + r + s\).
			\item \(\text{rank}(C) + \text{rank}(D) \leq \text{rank}(A + B) + \text{rank}(A) + \text{rank}(B)\), \(\text{rank}(E) + \text{rank}(F) \leq \text{rank}(A + B) + \text{rank}(A) + \text{rank}(B)\).
			\item Since \(CD\) is a factorization of \(A\), we have \(r = \text{rank}(A) = \text{rank}(C) = \text{rank}(D)\) because $C$ consists of a set of column vetor basis from $A$, which are independent, therefore \(\text{rank}(C) = r = \text{rank}(A)\). $D$ would need to be the same rank as $A$ to ensure that the product of $CD$ is the same rank as $A$, as $C$ has full colume rank.
			\item Similarly, \(EF\) is a factorization of \(B\), therefore we have \(s = \text{rank}(B) = \text{rank}(E) = \text{rank}(F)\).
			\item By substituting the ranks of \(C, D, E, F\) into the inequality, we get \(\text{rank}(A) + \text{rank}(A) \leq \text{rank}(A + B) + \text{rank}(A) + \text{rank}(B)\), \(\text{rank}(B) + \text{rank}(B) \leq \text{rank}(A + B) + \text{rank}(A) + \text{rank}(B)\).
			\item \(\text{rank}(A) \leq \text{rank}(A + B) + \text{rank}(B)\), \(\text{rank}(B) \leq \text{rank}(A + B) + \text{rank}(A)\)
			\item \(\text{rank}(A) - \text{rank}(B) \leq \text{rank}(A + B)\), \(\text{rank}(B) - \text{rank}(A) \leq \text{rank}(A + B)\)
			\item Therefore we can combine the two results above with an absolute value as when 
			\begin{itemize}
				\item \(\text{rank}(A) > \text{rank}(B)\), then \(\text{rank}(A + B) \geq \text{rank}(A) - \text{rank}(B) > 0 > \text{rank}(B) - \text{rank}(A)\)
				\item \(\text{rank}(A) < \text{rank}(B)\), then \(\text{rank}(A + B) \geq \text{rank}(B) - \text{rank}(A) > 0 > \text{rank}(A) - \text{rank}(B)\)
			\end{itemize}
			\item Therefore \(| \text{rank}(A) - \text{rank}(B) | \leq \text{rank}(A + B)\).
		\end{itemize}
	\end{enumerate}

	}
}








\end{document}
